---
layout: single
title:  "Ï£ºÌîºÌÑ∞(Jupyter) ÎÖ∏Ìä∏Î∂Å ÌååÏùº(ipynb) ÍπÉÌóàÎ∏å(github) Î∏îÎ°úÍ∑∏ Ïò¨Î¶¨Í∏∞"
---

```python
from mmdet.apis import init_detector, inference_detector
from mmdet.utils import register_all_modules
from mmdet.registry import VISUALIZERS
import mmcv
```

```python
# download the checkpoint demo
!mim download mmdet --config yolov3_mobilenetv2_8xb24-320-300e_coco --dest ./checkpoints
config_file = './checkpoints/yolov3_mobilenetv2_8xb24-320-300e_coco.py'
checkpoint_file = './checkpoints/yolov3_mobilenetv2_320_300e_coco_20210719_215349-d18dff72.pth'
```

    /home/sanbu/anaconda3/envs/mmlab2/lib/python3.7/site-packages/_distutils_hack/__init__.py:33: UserWarning: Setuptools is replacing distutils.
      warnings.warn("Setuptools is replacing distutils.")
    processing yolov3_mobilenetv2_8xb24-320-300e_coco...
    [32myolov3_mobilenetv2_320_300e_coco_20210719_215349-d18dff72.pth exists in /home/sanbu/mmdetection/demo/checkpoints[0m
    [32mSuccessfully dumped yolov3_mobilenetv2_8xb24-320-300e_coco.py to /home/sanbu/mmdetection/demo/checkpoints[0m

```python
#Register all modules in mmdet into the registries
register_all_modules()
# build the model from a config file and a checkpoint file
model = init_detector(config_file, checkpoint_file, device='cpu')  # or device='cuda:0'
```

    local loads checkpoint from path: ./checkpoints/yolov3_mobilenetv2_320_300e_coco_20210719_215349-d18dff72.pth

```python
# test a single image
img = mmcv.imread( 'demo.jpg', channel_order='rgb')
result = inference_detector(model, img)
print(result)
```

    <DetDataSample(
    
        META INFORMATION
        ori_shape: (427, 640)
        batch_input_shape: (224, 320)
        pad_shape: (224, 320)
        img_id: 0
        img_shape: (214, 320)
        img_path: None
        scale_factor: (0.5, 0.5011709601873536)
    
        DATA FIELDS
        ignored_instances: <InstanceData(
    
                META INFORMATION
    
                DATA FIELDS
            ) at 0x7fd5789efed0>
        _gt_instances: <InstanceData(
    
                META INFORMATION
    
                DATA FIELDS
            ) at 0x7fd57d8d0c50>
        gt_instances: <InstanceData(
    
                META INFORMATION
    
                DATA FIELDS
            ) at 0x7fd57d8d0c50>
        _pred_instances: <InstanceData(
    
                META INFORMATION
    
                DATA FIELDS
                bboxes: tensor([[224.3877, 181.1924, 454.1928, 374.6344],
                            [483.0889, 108.0703, 519.9299, 127.5264],
                            [407.6640, 113.0755, 436.7201, 130.1972],
                            [287.6279, 115.3127, 373.8157, 149.2711],
                            [187.4083, 111.9495, 304.5407, 154.9558],
                            [449.6842, 104.6975, 487.9407, 128.4959],
                            [609.1494, 108.0799, 631.1255, 130.8829],
                            [431.2960, 112.2748, 449.1858, 127.9686],
                            [381.4730, 137.2192, 432.4610, 191.3471],
                            [571.3628, 110.0467, 596.5579, 123.5843],
                            [545.4598, 110.5990, 558.1056, 122.6457],
                            [552.2471, 110.1847, 582.7968, 123.9531],
                            [267.2313, 107.5772, 326.0927, 137.7015],
                            [586.8149, 108.7947, 610.5984, 125.5578],
                            [  1.9415, 110.2905,  20.2367, 132.0406],
                            [529.5174, 110.8196, 541.1486, 123.3602],
                            [514.6877, 110.7249, 528.9530, 123.8707],
                            [275.9340, 107.3704, 309.2011, 128.4026],
                            [365.6169, 123.4124, 382.1004, 143.9408],
                            [139.2467,  93.2363, 165.2028, 104.3291],
                            [ 51.5301, 112.0692,  67.4710, 132.7515],
                            [398.1403, 113.8399, 425.5557, 130.5471],
                            [175.1511,  93.9253, 188.7445, 103.7817],
                            [ 83.7544,  90.4648, 116.6133, 107.4568],
                            [361.5199, 114.5963, 385.3239, 130.0186],
                            [ 74.5976,  87.7052, 105.5213,  99.4137],
                            [ 60.4158,  98.9154,  85.1626, 110.0114],
                            [ 86.6313,  88.2445, 114.3870,  99.9284],
                            [220.6624,  95.8883, 249.1597, 108.1394],
                            [161.8563, 108.2993, 231.4148, 141.0062],
                            [207.9770,  95.3961, 224.9070, 106.2001],
                            [230.5449,  98.8806, 259.9097, 111.0638],
                            [175.5828, 108.4224, 294.6472, 154.1141],
                            [156.8987,  94.3031, 181.6782, 105.1506],
                            [611.2281, 103.3027, 627.6701, 113.1402],
                            [354.7461, 114.1996, 369.2101, 126.7713],
                            [ 51.5301, 112.0692,  67.4710, 132.7515],
                            [325.6880, 114.4089, 358.0858, 127.6152],
                            [ 56.4891, 108.9750,  79.2878, 122.7916],
                            [ 55.9450,  89.6161, 121.2576, 117.7139],
                            [ 66.9669,  88.1433,  84.1316,  98.0804],
                            [278.5367, 103.0909, 309.9962, 114.1868],
                            [285.9398, 119.0878, 304.0997, 150.9880],
                            [255.2032,  98.2923, 274.0921, 111.2575],
                            [406.8245, 101.4302, 438.1498, 114.0530],
                            [299.3097, 112.4508, 324.1787, 129.1687],
                            [297.2524, 119.7446, 328.2043, 146.2322],
                            [287.6279, 115.3127, 373.8157, 149.2711],
                            [ 49.4358, 118.5914,  63.1868, 142.5933],
                            [546.9026, 104.8594, 554.8930, 112.9855],
                            [343.0991, 124.6689, 378.0575, 144.8195],
                            [192.4095,  95.5318, 209.0830, 106.6962],
                            [365.6169, 123.4124, 382.1004, 143.9408],
                            [ 49.4358, 118.5914,  63.1868, 142.5933],
                            [131.1579,  94.5455, 147.5900, 106.1010],
                            [407.6640, 113.0755, 436.7201, 130.1972],
                            [546.2800, 105.0825, 621.4587, 127.6568],
                            [622.0493, 101.6145, 634.9415, 110.8839],
                            [587.4097, 104.1442, 610.7798, 114.3494],
                            [451.5570, 101.6555, 521.1064, 128.8768],
                            [266.9005, 101.9758, 292.7127, 113.9188],
                            [449.9071, 102.4595, 463.1291, 111.8206],
                            [529.5174, 110.8196, 541.1486, 123.3602],
                            [140.2644,  89.4616, 160.7074,  99.7664],
                            [545.4598, 110.5990, 558.1056, 122.6457],
                            [  6.8616, 110.4829,  31.0714, 130.9146],
                            [215.4859, 108.4329, 375.9925, 155.5855],
                            [175.1511,  93.9253, 188.7445, 103.7817],
                            [165.6814, 110.8270, 202.9191, 134.9290],
                            [382.7891, 130.0242, 432.0781, 182.0306],
                            [275.9340, 107.3704, 309.2011, 128.4026],
                            [354.7461, 114.1996, 369.2101, 126.7713],
                            [357.4214, 107.9879, 429.2724, 135.2474],
                            [ 83.7544,  90.4648, 116.6133, 107.4568],
                            [255.2308,  86.5784, 270.5690,  94.3033],
                            [  0.8954, 116.0948,  21.3001, 145.9933],
                            [570.7006, 104.4805, 599.2065, 115.1720],
                            [320.5820, 113.1876, 340.5007, 125.7128],
                            [373.9546, 113.6809, 411.5591, 128.2304],
                            [461.0648, 103.1163, 480.0904, 112.9148],
                            [237.3674,  87.5856, 259.5656,  96.4916],
                            [ 74.5976,  87.7052, 105.5213,  99.4137],
                            [395.8581, 104.2521, 448.3419, 133.5048],
                            [611.4109, 123.3101, 629.1647, 135.5593],
                            [323.0317, 123.4838, 366.1406, 144.7441],
                            [399.0685, 123.4459, 419.6250, 139.1301],
                            [175.6967,  90.2450, 192.1692,  98.6459],
                            [404.3842, 101.6994, 419.1227, 111.8998],
                            [285.9398, 119.0878, 304.0997, 150.9880],
                            [406.8245, 101.4302, 438.1498, 114.0530],
                            [223.6637,  89.9171, 243.3517,  97.6498],
                            [404.1190, 124.7813, 433.4625, 184.0733],
                            [166.6963, 120.1215, 196.1296, 143.4019],
                            [449.9071, 102.4595, 463.1291, 111.8206],
                            [366.9586, 103.0422, 379.8078, 111.5556],
                            [373.4071, 159.6738, 412.6927, 178.3470],
                            [319.0899, 122.4915, 339.6975, 145.4802],
                            [558.9426, 104.3621, 575.5526, 114.2273],
                            [361.5199, 114.5963, 385.3239, 130.0186],
                            [ 86.6313,  88.2445, 114.3870,  99.9284]])
                scores: tensor([0.9802, 0.6648, 0.6520, 0.6476, 0.5502, 0.4795, 0.4493, 0.4348, 0.4059,
                            0.3737, 0.3649, 0.3439, 0.3072, 0.2969, 0.2923, 0.2660, 0.2462, 0.2377,
                            0.2287, 0.2271, 0.2052, 0.1899, 0.1754, 0.1717, 0.1682, 0.1604, 0.1511,
                            0.1503, 0.1439, 0.1423, 0.1233, 0.1091, 0.1038, 0.0957, 0.0811, 0.0785,
                            0.0776, 0.0760, 0.0702, 0.0633, 0.0567, 0.0544, 0.0533, 0.0514, 0.0498,
                            0.0495, 0.0493, 0.0469, 0.0468, 0.0460, 0.0446, 0.0436, 0.0432, 0.0432,
                            0.0428, 0.0396, 0.0358, 0.0357, 0.0354, 0.0348, 0.0347, 0.0321, 0.0306,
                            0.0306, 0.0304, 0.0303, 0.0285, 0.0265, 0.0260, 0.0258, 0.0252, 0.0244,
                            0.0239, 0.0236, 0.0235, 0.0230, 0.0229, 0.0223, 0.0222, 0.0222, 0.0218,
                            0.0218, 0.0217, 0.0209, 0.0205, 0.0201, 0.0201, 0.0200, 0.0198, 0.0197,
                            0.0194, 0.0192, 0.0187, 0.0168, 0.0168, 0.0166, 0.0163, 0.0154, 0.0152,
                            0.0149])
                labels: tensor([13,  2,  2,  2,  2,  2,  2,  2, 13,  2,  2,  2,  2,  2,  2,  2,  2,  2,
                             2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  7,  2,  2,  2,
                             0,  2,  2,  2,  2,  2,  0,  2,  2,  2,  2,  7,  2,  2,  2,  2,  0,  0,
                             2,  7,  2,  2,  2,  2,  2,  2,  0,  2,  0,  2,  2,  0,  2,  1,  0,  0,
                             2,  7,  2,  2,  2,  2,  2,  2,  2,  7,  2,  2,  2,  2,  2,  2,  2, 25,
                             2,  0,  2,  0,  2, 13,  0,  2,  7,  7])
            ) at 0x7fd5b026ec90>
        pred_instances: <InstanceData(
    
                META INFORMATION
    
                DATA FIELDS
                bboxes: tensor([[224.3877, 181.1924, 454.1928, 374.6344],
                            [483.0889, 108.0703, 519.9299, 127.5264],
                            [407.6640, 113.0755, 436.7201, 130.1972],
                            [287.6279, 115.3127, 373.8157, 149.2711],
                            [187.4083, 111.9495, 304.5407, 154.9558],
                            [449.6842, 104.6975, 487.9407, 128.4959],
                            [609.1494, 108.0799, 631.1255, 130.8829],
                            [431.2960, 112.2748, 449.1858, 127.9686],
                            [381.4730, 137.2192, 432.4610, 191.3471],
                            [571.3628, 110.0467, 596.5579, 123.5843],
                            [545.4598, 110.5990, 558.1056, 122.6457],
                            [552.2471, 110.1847, 582.7968, 123.9531],
                            [267.2313, 107.5772, 326.0927, 137.7015],
                            [586.8149, 108.7947, 610.5984, 125.5578],
                            [  1.9415, 110.2905,  20.2367, 132.0406],
                            [529.5174, 110.8196, 541.1486, 123.3602],
                            [514.6877, 110.7249, 528.9530, 123.8707],
                            [275.9340, 107.3704, 309.2011, 128.4026],
                            [365.6169, 123.4124, 382.1004, 143.9408],
                            [139.2467,  93.2363, 165.2028, 104.3291],
                            [ 51.5301, 112.0692,  67.4710, 132.7515],
                            [398.1403, 113.8399, 425.5557, 130.5471],
                            [175.1511,  93.9253, 188.7445, 103.7817],
                            [ 83.7544,  90.4648, 116.6133, 107.4568],
                            [361.5199, 114.5963, 385.3239, 130.0186],
                            [ 74.5976,  87.7052, 105.5213,  99.4137],
                            [ 60.4158,  98.9154,  85.1626, 110.0114],
                            [ 86.6313,  88.2445, 114.3870,  99.9284],
                            [220.6624,  95.8883, 249.1597, 108.1394],
                            [161.8563, 108.2993, 231.4148, 141.0062],
                            [207.9770,  95.3961, 224.9070, 106.2001],
                            [230.5449,  98.8806, 259.9097, 111.0638],
                            [175.5828, 108.4224, 294.6472, 154.1141],
                            [156.8987,  94.3031, 181.6782, 105.1506],
                            [611.2281, 103.3027, 627.6701, 113.1402],
                            [354.7461, 114.1996, 369.2101, 126.7713],
                            [ 51.5301, 112.0692,  67.4710, 132.7515],
                            [325.6880, 114.4089, 358.0858, 127.6152],
                            [ 56.4891, 108.9750,  79.2878, 122.7916],
                            [ 55.9450,  89.6161, 121.2576, 117.7139],
                            [ 66.9669,  88.1433,  84.1316,  98.0804],
                            [278.5367, 103.0909, 309.9962, 114.1868],
                            [285.9398, 119.0878, 304.0997, 150.9880],
                            [255.2032,  98.2923, 274.0921, 111.2575],
                            [406.8245, 101.4302, 438.1498, 114.0530],
                            [299.3097, 112.4508, 324.1787, 129.1687],
                            [297.2524, 119.7446, 328.2043, 146.2322],
                            [287.6279, 115.3127, 373.8157, 149.2711],
                            [ 49.4358, 118.5914,  63.1868, 142.5933],
                            [546.9026, 104.8594, 554.8930, 112.9855],
                            [343.0991, 124.6689, 378.0575, 144.8195],
                            [192.4095,  95.5318, 209.0830, 106.6962],
                            [365.6169, 123.4124, 382.1004, 143.9408],
                            [ 49.4358, 118.5914,  63.1868, 142.5933],
                            [131.1579,  94.5455, 147.5900, 106.1010],
                            [407.6640, 113.0755, 436.7201, 130.1972],
                            [546.2800, 105.0825, 621.4587, 127.6568],
                            [622.0493, 101.6145, 634.9415, 110.8839],
                            [587.4097, 104.1442, 610.7798, 114.3494],
                            [451.5570, 101.6555, 521.1064, 128.8768],
                            [266.9005, 101.9758, 292.7127, 113.9188],
                            [449.9071, 102.4595, 463.1291, 111.8206],
                            [529.5174, 110.8196, 541.1486, 123.3602],
                            [140.2644,  89.4616, 160.7074,  99.7664],
                            [545.4598, 110.5990, 558.1056, 122.6457],
                            [  6.8616, 110.4829,  31.0714, 130.9146],
                            [215.4859, 108.4329, 375.9925, 155.5855],
                            [175.1511,  93.9253, 188.7445, 103.7817],
                            [165.6814, 110.8270, 202.9191, 134.9290],
                            [382.7891, 130.0242, 432.0781, 182.0306],
                            [275.9340, 107.3704, 309.2011, 128.4026],
                            [354.7461, 114.1996, 369.2101, 126.7713],
                            [357.4214, 107.9879, 429.2724, 135.2474],
                            [ 83.7544,  90.4648, 116.6133, 107.4568],
                            [255.2308,  86.5784, 270.5690,  94.3033],
                            [  0.8954, 116.0948,  21.3001, 145.9933],
                            [570.7006, 104.4805, 599.2065, 115.1720],
                            [320.5820, 113.1876, 340.5007, 125.7128],
                            [373.9546, 113.6809, 411.5591, 128.2304],
                            [461.0648, 103.1163, 480.0904, 112.9148],
                            [237.3674,  87.5856, 259.5656,  96.4916],
                            [ 74.5976,  87.7052, 105.5213,  99.4137],
                            [395.8581, 104.2521, 448.3419, 133.5048],
                            [611.4109, 123.3101, 629.1647, 135.5593],
                            [323.0317, 123.4838, 366.1406, 144.7441],
                            [399.0685, 123.4459, 419.6250, 139.1301],
                            [175.6967,  90.2450, 192.1692,  98.6459],
                            [404.3842, 101.6994, 419.1227, 111.8998],
                            [285.9398, 119.0878, 304.0997, 150.9880],
                            [406.8245, 101.4302, 438.1498, 114.0530],
                            [223.6637,  89.9171, 243.3517,  97.6498],
                            [404.1190, 124.7813, 433.4625, 184.0733],
                            [166.6963, 120.1215, 196.1296, 143.4019],
                            [449.9071, 102.4595, 463.1291, 111.8206],
                            [366.9586, 103.0422, 379.8078, 111.5556],
                            [373.4071, 159.6738, 412.6927, 178.3470],
                            [319.0899, 122.4915, 339.6975, 145.4802],
                            [558.9426, 104.3621, 575.5526, 114.2273],
                            [361.5199, 114.5963, 385.3239, 130.0186],
                            [ 86.6313,  88.2445, 114.3870,  99.9284]])
                scores: tensor([0.9802, 0.6648, 0.6520, 0.6476, 0.5502, 0.4795, 0.4493, 0.4348, 0.4059,
                            0.3737, 0.3649, 0.3439, 0.3072, 0.2969, 0.2923, 0.2660, 0.2462, 0.2377,
                            0.2287, 0.2271, 0.2052, 0.1899, 0.1754, 0.1717, 0.1682, 0.1604, 0.1511,
                            0.1503, 0.1439, 0.1423, 0.1233, 0.1091, 0.1038, 0.0957, 0.0811, 0.0785,
                            0.0776, 0.0760, 0.0702, 0.0633, 0.0567, 0.0544, 0.0533, 0.0514, 0.0498,
                            0.0495, 0.0493, 0.0469, 0.0468, 0.0460, 0.0446, 0.0436, 0.0432, 0.0432,
                            0.0428, 0.0396, 0.0358, 0.0357, 0.0354, 0.0348, 0.0347, 0.0321, 0.0306,
                            0.0306, 0.0304, 0.0303, 0.0285, 0.0265, 0.0260, 0.0258, 0.0252, 0.0244,
                            0.0239, 0.0236, 0.0235, 0.0230, 0.0229, 0.0223, 0.0222, 0.0222, 0.0218,
                            0.0218, 0.0217, 0.0209, 0.0205, 0.0201, 0.0201, 0.0200, 0.0198, 0.0197,
                            0.0194, 0.0192, 0.0187, 0.0168, 0.0168, 0.0166, 0.0163, 0.0154, 0.0152,
                            0.0149])
                labels: tensor([13,  2,  2,  2,  2,  2,  2,  2, 13,  2,  2,  2,  2,  2,  2,  2,  2,  2,
                             2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  7,  2,  2,  2,
                             0,  2,  2,  2,  2,  2,  0,  2,  2,  2,  2,  7,  2,  2,  2,  2,  0,  0,
                             2,  7,  2,  2,  2,  2,  2,  2,  0,  2,  0,  2,  2,  0,  2,  1,  0,  0,
                             2,  7,  2,  2,  2,  2,  2,  2,  2,  7,  2,  2,  2,  2,  2,  2,  2, 25,
                             2,  0,  2,  0,  2, 13,  0,  2,  7,  7])
            ) at 0x7fd5b026ec90>
        _ignored_instances: <InstanceData(
    
                META INFORMATION
    
                DATA FIELDS
            ) at 0x7fd5789efed0>
    ) at 0x7fd5b026e890>

```python
# init the visualizer(execute this block only once)
visualizer = VISUALIZERS.build(model.cfg.visualizer)
# the dataset_meta is loaded from the checkpoint and
# then pass to the model in init_detector
visualizer.dataset_meta = model.dataset_meta
```

    /home/sanbu/anaconda3/envs/mmlab2/lib/python3.7/site-packages/mmengine/visualization/visualizer.py:170: UserWarning: `Visualizer` backend is not initialized because save_dir is None.
      warnings.warn('`Visualizer` backend is not initialized '

```python
# show the results
visualizer.add_datasample(
    'result',
    img,
    data_sample=result,
    draw_gt=False,
    wait_time=0,
)
visualizer.show()
```

![png](2022-11-27-second_files/2022-11-27-second_5_0.png)

```python
jupyter nbconvert --to markdown JUPYTER_NOTEBOOK.ipynb
```

      Cell In [1], line 1
        jupyter nbconvert --to markdown JUPYTER_NOTEBOOK.ipynb
                ^
    SyntaxError: invalid syntax
